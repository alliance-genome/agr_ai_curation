# Gitleaks configuration for Alliance AI Curation System
title = "Alliance AI Curation - Gitleaks Config"

# Custom rules for specific patterns in our application
[[rules]]
id = "openai-api-key"
description = "OpenAI API Key"
regex = '''sk-[a-zA-Z0-9]{20}T3BlbkFJ[a-zA-Z0-9]{20}'''
keywords = ["sk-"]

[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-api03-[a-zA-Z0-9\-_]{95}'''
keywords = ["sk-ant-api03"]

[[rules]]
id = "generic-api-key"
description = "Generic API Key patterns"
regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*["\']?[a-zA-Z0-9\-_]{20,}["\']?'''
keywords = ["api_key", "apikey", "api-key"]

[[rules]]
id = "database-url"
description = "Database connection URL"
regex = '''(?i)(database_?url|db_?url|connection_?string)\s*[:=]\s*["\']?[a-zA-Z]+://[^\s"']+["\']?'''
keywords = ["database_url", "db_url", "connection_string"]

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[a-zA-Z0-9\-_]+\.eyJ[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+'''
keywords = ["eyJ"]

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN [A-Z]+ PRIVATE KEY-----'''
keywords = ["BEGIN", "PRIVATE KEY"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
keywords = ["AKIA"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws.{0,20}["\']?[0-9a-zA-Z/+]{40}["\']?'''
keywords = ["aws"]

[[rules]]
id = "github-token"
description = "GitHub Token"
regex = '''ghp_[a-zA-Z0-9]{36}'''
keywords = ["ghp_"]

[[rules]]
id = "generic-secret"
description = "Generic secret patterns"
regex = '''(?i)(secret|password|passwd|pwd|auth)\s*[:=]\s*["\']?[a-zA-Z0-9\-_!@#$%^&*()]{8,}["\']?'''
keywords = ["secret", "password", "passwd", "auth"]

# Allowlist for known safe patterns
[allowlist]
description = "Allowlist for safe patterns"
regexes = [
    '''sk-proj-test''',  # Test API keys
    '''example\.com''',  # Example domains
    '''localhost''',     # Local development
    '''127\.0\.0\.1''',   # Local IP
    '''password.*example''', # Example passwords in documentation
    '''secret.*placeholder''', # Placeholder secrets
    '''session_token''',  # SQLAlchemy column names and test values
]

paths = [
    '''\.secrets\.baseline$''',  # Our secrets baseline file
    '''\.git/''',                # Git directory
    '''node_modules/''',         # Dependencies
    '''venv/''',                 # Python virtual environment
    '''\.env\.example$''',       # Example env file is OK
    '''README\.md$''',           # Documentation
    '''\.md$''',                 # Markdown files (but be careful)
    '''frontend/public/pdfjs/''', # PDF.js library files
]

# File extensions to ignore
[allowlist.files]
paths = [
    '''\.lock$''',      # Lock files
    '''\.log$''',       # Log files (but be careful with these)
    '''\.svg$''',       # SVG files
    '''\.png$''',       # Image files
    '''\.jpg$''',       # Image files
    '''\.pdf$''',       # PDF files
]
